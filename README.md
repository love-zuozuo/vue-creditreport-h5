



# 系统、功能设计文档

# 具体标准如下：

# 1.整体目标
  实现小启信用1.0.0版本开发，满足于产品定位要求

# 2.总体功能概述
  * 2.1 注册/登录
  - 包含手机与验证码输入，用户获取验证码时间为60s

  * 2.2 信息检测首页
  - 主要功能包含：用户登录后信息展示位，综合风险核查入口（包含加强版），电商数据查询入口，小启资讯展示与更多入口

  * 2.3 综合风险核查-加强版  查询页
  - 主要功能包含：查询对象录入，样例报告入口，历史报告入口，支付功能，风险报告查询结果

  * 2.4 淘宝信息 查询页
  - 主要功能包含：查询对象录入，样例报告入口，历史报告入口，支付功能，风险报告查询结果

  * 2.5 京东信息 查询页
  - 主要功能包含：查询对象录入，样例报告入口，历史报告入口，支付功能，风险报告查询结果 

  * 2.6 确定订单页
  - 获取支付订单信息与支付流转

  * 2.7 样例报告
  - 静态展示样例内容

  * 2.8 历史报告
  - 展示历史报告列表与详情页
  
  * 2.9 小启咨讯
  - 静态展示咨询首页与详情页  





# 3.整体框架选择
* 3.1：技术整体选型
   * 前端框架 mvvm架构  vue全家桶
   * ui组件 vant
   * 网络请求 axios
   * css预编译器 less
   * 项目打包 webpack
   * 适配方案 lib-flexible 以750宽度适配 12px=1rem

   

* 3.2：整体框架图  
  
    ![登录/注册流程图](https://file.tapd.cn/31279820/documents/preview/1131279820001000334)


   ```
   ├── dist--打包生成文件夹
   │   
   ├── config  
   │   └── index.js  打包输出配置
   |   
   │
   ├── src 项目主体输出
   │    │
   │    └── views 界面文件夹
   │    │  
   │    └── assets 资源文件(打包)
   │    │
   │    └──components 公用组件
   │    │
   │    └──router 路由配置
   │    │  
   │    └──http.js 请求配置
   │    
   ├── static 静态资源（不打包）
   │    └──config.js 域名配置文件
   |
   ├── package.json node库配置与安装依赖
   │   
   │
   └── index.html  全局单界面输出文件
   

* 3.3：代码规范
   - router/router.js 权限路由配置  
   - router/index.js 基础路由配置
   ~
    const routes = [
        {
            path:"/index", //首页
            component: index
        },
        {
            path:"/login", //登录
            component: login
        },
        {
            path: '/',   // 重定向
            redirect: '/index'
        },
        ...Router.routes
        ]

        var router =  new VueRouter({
        routes
    })
   ~ 

   * /src/http.js 全局请求封装
     - import {post,get} from './http'
     - Vue.prototype.$post=post;
     - Vue.prototype.$get=get;

   * static/config.js 全局配置参数 
     - window.base = "http://localhost:8080"; 请求后端接口域名

   * /src/assets/js/rule.js 使用同一表单校验 
    ~
      export const Rule = {
        /**
          * checkDataLength 验证数据长度
          * min 最小字符
          * max 最大字符
          */
          checkDataLength: (value,min, max) => {
              if (!value) {
                  Toast('输入内容不能为空')
                  return false
              }
              if(!min<=value.length<=max){
                  Toast('请输入'+min+'位至'+max+'位')
                  return false 
              }
              return true
          },


          /**
          * checkDataPhone 验证手机号
          */
          checkDataPhone: (value) => {
              const reg = /^1[3|4|5|6|7|8|9][0-9]\d{8}$/
              if (!value) {
                  Toast('手机号不能为空')
                  return false
              }
              if (!reg.test(value)) {
                  Toast('请输入正确的手机号')
                  return false
              } 
              return true
          },

        ...
    ~

   * 全局请求采用统一封装，统一异常处理
     code：20000  请求成功  code：30000 登录过期回登录  code其它 异常弹框
     

# 3.4：对外交互
   * rap项目地址：http://rap2.78dk.com/workspace/myWorkspace.do?projectId=71
   * tapd项目地址：https://www.tapd.cn/31279820/prong/stories/stories_list 

# 4.软件支持
  * 开发工具：vscode，Sublime Text 3
  * 支持版本：谷歌（50.0.3538.110）版本以上，火狐（50.0.0）版本以上，ie9以上
  * 支持的软件环境：window xp以上，ios系统

# 5.详细设计 
* 1.0.0版本
    * 登录/注册
      - 整体逻辑：输入手机号，获取验证码，最终完成登录，验证码有效期为60s
      - 校验：手机号格式校验，验证码6位数字校验 


    * 信息检测首页
      - 整体逻辑：界面主要是展示信息为主，包含：用户登录后信息，综合风险核查入口（包含加强版），电商数据查询入口，小启资讯展示与更多入口
      - 当用户未登录时候，不展示用户登录信息，用户已登录时候展示用户登录信息
      - 购买信息栏做翻转效果，每4秒翻转一次

    * 综合风险核查-加强版  查询页  
      - 整体逻辑：获取查询对象信息，再检测，该模块为收费模块，当立即检测时，需要先验证用户是否登录，已登录用户支付购买后方可查询数据，    未登录用户需先登录在后续操作。
      - 校验：姓名限制10个字符，身份证号长度限制18位，手机号格式

    * 淘宝信息 查询页
      - 整体逻辑：两种登录方式：手机号登录与账户密码登录 ，登录完成时候，需要先验证用户是否登录，已登录用户支付购买后方可查询数据， 未登录    用 户需先登录在后续操作。(该模块为免费模块，支付金额默认为0)
      - 校验：手机号格式，6位验证码，用户名和密码为空。
      - 当连续输入错误5次，需要图片验证码进行验证后查询。

    * 京东信息 查询页
      - 整体逻辑：两种登录方式：手机号登录与账户密码登录 ，登录完成时候，需要先验证用户是否登录，已登录用户支付购买后方可查询数据， 未登录    用 户需先登录在后续操作。(该模块为免费模块，支付金额默认为0)
      - 校验：手机号格式，6位验证码，用户名和密码为空。
      - 当连续输入错误5次，需要图片验证码进行验证后查询。 

    * 确认订单页 
      - 整体逻辑：展示扫描项目，显示收费金额，立即支付成功后，在跳转到报告等待界面

    * 小启资讯页
      - 整体逻辑：静态展示资讯界面，数据暂时写死

    * 历史报告页
      - 整体逻辑：根据当前用户查询用户历史报告数据展示列表，查看可进入具体每一条报告
      - 校验：未登录用户查询时，需要先登录方可操作

    * 样例报告页      
      - 整体逻辑：静态展示报告详情界面,数据写死

* 1.3.1.1版本
		* 样例报告拆分
			- 整体逻辑：将样例报告拆分为综合风险、加强版、多头和黑名单四个，分别通过不同的报告查询页面跳转

* 1.3.1.2版本
		* 新增注册入口
			- 整体逻辑：首页增加注册按钮，点击注册；每个报告查询入口都增加注册判断，查询内页取消注册判断
		
		* 加强/标准版增加二次验证功能
			- 整体逻辑：在用户输入完成身份信息，点击“立即检测”，弹出验证码进行二次验证。1）若输入正确，则进入下一步验证，最后一步输入成功，弱提示“验证成功”；2）若输入错误，则弱提示“输入错误，验证码已重发”。

		* 运营商服务密码输入加密展示
			- 整体逻辑：输入框加密显示
		
		* 报告查询页协议强制阅读时间修改
			- 整体逻辑：强制阅读时间改为6s

		* 历史报告页面增加查询更多报告入口
			- 整体逻辑：每个tab页分别增加跳转到不同报告的查询入口

		* 增加支付价格字段展示
			- 整体逻辑：历史报告页增加价格字段

		* 京东淘宝报告字段补充优化
			- 整体逻辑：增加相关字段，增加收货地址Top3

		* 标准版报告字段补充优化
			- 整体逻辑：个人信息核查字段固化，没有展示0
		
		* 加强版报告字段补充优化
			- 整体逻辑：1）个人信息核查字段固化，没有展示0；2）申请次数监控模块增加

* 1.3.2.1版本
		* 启屏页
			- 整体逻辑：取消启屏页，更改公众号配置入口链接为/index
		* 首页
			- 整体逻辑：banner图改回原版本，取消banner图的点击事件及详情页跳转
		* 贷超报告页面
			整体逻辑：设置综合版报告、加强版报告及样例报告文字不可复制
		* 公众号报告页面
			整体逻辑：淘宝、京东、综合、加强、黑名单、多头报告及所有样例报告设置文字不可复制


* 1.3.2.2版本
		* 电商入参
			- 整体逻辑：加强版报告加入电商授权入口，授权且拉取报告成功后可以在加强版报告中刷新报告评分和电商报告参数
			- 具体实现：1）增加电商报告授权入口；2）授权成功后跳转加载中页面（同步拉取电商报告）；3）报告拉取成功后跳转回报告页，显示电商报告，更新评分；4）电商报告只与当前报告绑定，不在历史报告列表中显示
			- 设计：1）历史列表中点击加强版报告先判断是否处于电商报告拉取中，若在拉取中，跳转到loading页面，否则跳转到报告详情页面；2）加强版报告详情页中，当电商报告状态为未拉取或是拉取失败两种状态时会显示报告查询入口；3）电商报告拉取成功的加强版报告中会展示电商基本信息，且会刷新报告分数


        


    
   

# 6.其他设计
* 6.1：异常处理   
   * 前端请求后端，后端无响应，50s后自动退出请求
   * 路由守卫：所有界面请求渲染之前针对token做是否存在处理，缓存无token会自动跳到登录界面
   * 用户输入非有效的地址，前端做了过滤路由拦截处理，跳转到默认的首页
   

   
* 6.2：安全设计
   * 登录时，采用md5加密

  

* 6.3：用户性能设计
   * 前端逐步采用组件分发式开发，避免每个界面加载代码过多
   * 去除非必要的冗余，减少逻辑处理
   * 优化写法




# 项目运行

``` bash
# 安装node
npm install

# 运行
npm run dev

# 打包
npm run build

```



